(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})}};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),t.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&(e=n.currentScript.src),!e)){var r=n.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e})(),t.d({},{PR:()=>y,PC:()=>v});const e=t.p+"50848063708bcbff2c82.svg",n=t.p+"9ad6ffe7917e8cecd4cd.svg",r=t.p+"0e43280842ea6089082e.svg",o=function(){function t(t){this.mockCount=t,this.init()}return t.prototype.init=function(){this.addContentMock(this.mockCount),this.commentsFilter()},t.prototype.addContentMock=function(t){for(var e=document.querySelector(".contentMock"),n=0;n<t;n++){var r=document.createElement("div");r.classList.add("contentMockElement"),n===t-1&&r.classList.add("span"),e.appendChild(r)}},t.prototype.commentsFilter=function(){var t=document.getElementById("arrow"),o=document.getElementById("heart"),a=document.querySelector(".reply"),i=document.getElementById("comment-sort");t&&(t.src=e,i.addEventListener("click",(function(){t.classList.toggle("select-rotated")}))),o&&(o.src=n),a&&(a.src=r)},t}();const a=function(){function t(){}return t.prototype.updateAvatar=function(t){this.avatar=t,document.querySelector(".userAvatar").src=t},t.prototype.updateUserName=function(t){this.userName=t,document.querySelector(".userName").textContent=this.userName},t.prototype.addCommentUI=function(t){var e=document.createElement("div");e.classList.add("publishedComment");var n=v.value;e.innerHTML='\n    <img\n    class="commentAvatar"\n    src="'.concat(t.author.avatar,'"\n    alt="Аватар пользователя"\n  />\n  \n  <div class="userNameAndFormWrapper">\n    <div class="userNameWrapper">\n      <span class="commentUserName">').concat(t.author.userName,'</span>\n  \n      <div class="date">').concat(t.timestamp,'</div>\n    </div>\n  \n    <div class="publishedCommentText">').concat(n,'</div>\n    <div class="actionButtons">\n      <button class="reply">Ответить</button>\n      <button class="toFavorite" data-comment-id="').concat(t.id,'">В избранное</button>\n    </div>\n  </div>\n\n\n\n    '),y.appendChild(e),v.value=""},t}();var i=function(){function t(){this.userData=null,this.userData=null}return t.prototype.load=function(t){return e=this,n=void 0,o=function(){var e,n,r;return function(t,e){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(t,i)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,fetch(t)];case 1:if(!(e=o.sent()).ok)throw new Error("HTTP error! status: ".concat(e.status));return[4,e.json()];case 2:return n=o.sent(),this.userData={userId:n.results[0].login.uuid,userName:n.results[0].login.username,avatar:n.results[0].picture.large},[2,this.userData];case 3:return r=o.sent(),console.error("Ошибка при получении данных",r),this.userData=null,[3,4];case 4:return[2]}}))},new((r=void 0)||(r=Promise))((function(t,a){function i(t){try{s(o.next(t))}catch(t){a(t)}}function c(t){try{s(o.throw(t))}catch(t){a(t)}}function s(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(i,c)}s((o=o.apply(e,n||[])).next())}));var e,n,r,o},t.prototype.getData=function(){return this.userData},t.prototype.fetchData=function(){var t=this;this.load("https://randomuser.me/api/").then((function(){var e=t.getData();if(e){var n=new a;n.updateAvatar(e.avatar),n.updateUserName(e.userName)}}))},t}();const c=i,s={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let u;const l=new Uint8Array(16);function d(){if(!u&&(u="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!u))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return u(l)}const p=[];for(let t=0;t<256;++t)p.push((t+256).toString(16).slice(1));const m=function(t,e,n){if(s.randomUUID&&!e&&!t)return s.randomUUID();const r=(t=t||{}).random||(t.rng||d)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(let t=0;t<16;++t)e[n+t]=r[t];return e}return function(t,e=0){return p[t[e+0]]+p[t[e+1]]+p[t[e+2]]+p[t[e+3]]+"-"+p[t[e+4]]+p[t[e+5]]+"-"+p[t[e+6]]+p[t[e+7]]+"-"+p[t[e+8]]+p[t[e+9]]+"-"+p[t[e+10]]+p[t[e+11]]+p[t[e+12]]+p[t[e+13]]+p[t[e+14]]+p[t[e+15]]}(r)},f=function(){function t(t,e){this.id=m(),this.author=t,this.content=e,this.timestamp=this.getFormattedDate(),this.rating=0,this.replies=[],this.isFavorite=!1}return t.prototype.addReply=function(t){this.replies.push(t)},t.prototype.getFormattedDate=function(){var t=new Date,e=t.getDate().toString().padStart(2,"0"),n=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getHours().toString().padStart(2,"0"),o=t.getMinutes().toString().padStart(2,"0");return"".concat(e,".").concat(n," ").concat(r,":").concat(o)},t}(),h=function(){function t(){this.localStorageKey="comments"}return t.prototype.loadComments=function(){var t=localStorage.getItem(this.localStorageKey);return t?JSON.parse(t):[]},t.prototype.saveComments=function(t){localStorage.setItem(this.localStorageKey,JSON.stringify(t))},t.prototype.addComment=function(t){var e=this.loadComments();e.push(t),this.saveComments(e)},t.prototype.toggleFavorite=function(t){var e=this.loadComments(),n=e.find((function(e){return e.id===t}));n&&(n.isFavorite=!n.isFavorite,this.saveComments(e))},t.prototype.updateRating=function(t,e){var n=this.loadComments(),r=n.find((function(e){return e.id===t}));r&&(r.rating+=e?1:-1,this.saveComments(n))},t}();document.querySelector(".wrapper"),document.querySelector(".warning"),document.querySelector(".send-btn");var v=document.getElementById("comment"),y=document.querySelector(".commentsBlock"),g=document.getElementById("commentForm");document.querySelector(".toFavorite"),new o(9);var b=new c,w=new a,S=new h;document.addEventListener("DOMContentLoaded",(function(){b.fetchData(),g.addEventListener("submit",(function(t){if(t.preventDefault(),v){var e=b.getData();if(e){var n=new f(e,v.value);S.addComment(n),w.addCommentUI(n),b.fetchData()}}})),y.addEventListener("click",(function(t){var e=t.target;if(e.classList.contains("toFavorite")){var n=e.getAttribute("data-comment-id");n&&(S.toggleFavorite(n),e.textContent="В избранном",e.style.backgroundImage='url("./assets/heartFilled.svg")')}}))}))})();